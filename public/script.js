const socket=io(),messageContainer=document.querySelector("#message-container"),messageForm=document.getElementById("sent-container"),messageInput=document.getElementById("message-input"),onlineUsersNum=document.getElementById("online-Users");var audio=new Audio("swiftly-610.mp3");let onlineUsers={},name="";do name=prompt("Enter your name");while(null==name||""==name);const docTitle=document.title;let notificationCount=0;socket.emit("new-user",name),socket.on("chat-message",a=>{""!=a.name&&null!=a.name&&a.name!=null&&(appendMessage(`${a.name}: ${a.message}`),$(messageContainer).scrollTop(2e3),audio.play(),document.hasFocus()?(notificationCount=0,document.title=docTitle):(notificationCount++,document.title=docTitle+" ("+notificationCount+")"))}),socket.on("user-connected",a=>{appendMessage(a+" connected")}),socket.on("user-disconnected",a=>{""!=a&&null!=a&&a!=null&&appendMessage(a+" disconnected")}),socket.on("disconnect",()=>{appendMessage("Connection Error...","red")}),socket.on("reconnect",()=>{messageContainer.lastChild.remove(),socket.emit("new-user",name)}),socket.on("users-online",a=>{onlineUsers=a;let b=Object.values(onlineUsers).findIndex(a=>a==name),c=Object.values(onlineUsers);c[b]+="(You)",onlineUsersNum.innerText=c}),messageForm.addEventListener("submit",a=>{a.preventDefault(),handleDefaultFormSubmit()});function appendMessage(a,b="black"){const c=document.createElement("div");c.innerText=a,c.style.color="self"==b?"#0275d8":b,messageContainer.append(c)}function handleDefaultFormSubmit(){const a=messageInput.value;appendMessage(`${a}`,"self"),socket.emit("send-chat-message",a),messageInput.value="",$(messageContainer).scrollTop(2e3)}$("#message-input").keypress(function(a){13!=a.keyCode||a.ctrlKey||(a.preventDefault(),$("#sent-container").submit(function(){return!1}),handleDefaultFormSubmit())});